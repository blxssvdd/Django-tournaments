# Tournament Arena

Tournament Arena - веб-приложение на Django для организации турниров, команд и составов игроков с социальной авторизацией и пользовательскими профилями.

## Возможности
- Турниры: создание, редактирование и удаление турниров с названием, площадкой, описанием, датой и баннером; упорядоченные списки, кешированный список для каждого пользователя (30 с) и пагинация (3 на страницу) с учетом количества регистраций у авторизованных.
- Команды и игроки: создание команд с эмблемами и привязкой к турниру, редактирование/удаление с проверкой прав, вступление или выход из команды от лица пользователя, уникальность участия по паре пользователь-команда, ручное добавление игроков при наличии прав управления ростером.
- Регистрации: добавление нескольких слотов для себя на турнир, просмотр персонального сводного списка с общей суммой, уменьшение или полное удаление записи за пару кликов.
- Аккаунты и профили: регистрация с капчей, вход/выход, сброс и смена пароля, одно-клик вход через Google (django-allauth), профиль с отображаемым именем, био и аватаром, сообщения об успехе или ошибке на страницах.
- UI и хранение: Django Templates с формами в стиле Bootstrap, загрузка медиа в `media/`, легкий кеш для быстрых страниц турниров.

## Стек
- Django 5.2, Python 3.11+, MySQL (через `ENGINE/NAME/USER/PASSWORD/HOST/PORT`).
- Авторизация и безопасность: django-allauth (Google), django.contrib.auth, captcha.
- Конфигурация: `pydantic-settings` читает `.env` через `config.py`.
- Медиа: Pillow для загрузки баннеров, эмблем и аватаров.
- Рантайм: `LocMemCache` для быстрых списков; готовность к деплою на gunicorn.

## Структура проекта
```
.
├── manage.py
├── config.py
├── GamesTournaments/   # турниры, команды, регистрации
├── UserManager/        # аутентификация, профили, соцлогин
├── templates/          # Django-шаблоны
├── media/              # загруженные файлы (в .gitignore)
├── requirements.txt
└── .env                # локальные секреты и настройки БД
```

## Запуск (локально)
1) Создайте виртуальное окружение и установите зависимости:
```
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```
2) Создайте `.env` в корне проекта:
```
ENGINE=django.db.backends.mysql
NAME=tournaments_db
USER=tournaments_user
PASSWORD=your_password
HOST=localhost
PORT=3306
SECRET_KEY=django-insecure-change-me
```
3) Примените миграции и создайте администратора:
```
python manage.py migrate
python manage.py createsuperuser
```
4) Запустите сервер:
```
python manage.py runserver
```
5) (Опционально) Настройте Google OAuth в `/admin/socialaccount/socialapp/`, затем проверьте социальный вход.

## Полезные команды
- `python manage.py collectstatic --noinput` — собрать статику перед деплоем.
- `python manage.py test` — запустить тесты Django.
- `python manage.py changepassword <username>` — сменить пароль через CLI.
- `python manage.py shell` — выдать права `manage_tournaments`, `manage_teams` или `manage_roster` и настроить группы через код.

## Заметки
- Списки турниров кешируются для каждого пользователя на 30 секунд; после правок турниров или команд кеш очищается, поэтому обновления видны сразу.
- Медиа-файлы хранятся в `media/`; директория должна быть доступна для записи локально и подключена к постоянному хранилищу в продакшене.
- В разработке почтовый бэкенд выводит письма в консоль, поэтому перед использованием сброса пароля в продакшене подключите SMTP.
