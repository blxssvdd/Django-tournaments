{% extends "base.html" %}

{% block title %}Головна · Tournament Arena{% endblock %}

{% block content %}
<div class="hero-banner text-center text-light mb-5">
    <h1 class="display-5 fw-bold">Ласкаво просимо до Tournament Arena</h1>
    <p class="lead mb-4">Організовуйте турніри, керуйте командами та створюйте історію перемог.</p>
    {% if perms.GamesTournaments.manage_tournaments %}
        <a class="btn btn-glow btn-lg" href="{% url 'add_tournament' %}">Створити турнір</a>
    {% else %}
        <a class="btn btn-outline-light btn-lg" href="{% url 'sign_up' %}">Приєднатись</a>
    {% endif %}
</div>

{% if featured_tournaments %}
    <h2 class="text-light mb-3">Популярні турніри</h2>
    <div class="row g-4">
        {% for tournament in featured_tournaments %}
            <div class="col-md-6 col-xl-4">
                <div class="card tournament-card h-100 shadow-sm">
                    <div class="card-body d-flex flex-column">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-gradient">{{ tournament.count }} команд</span>
                            <span class="text-soft small">{{ tournament.date|date:"d.m.Y" }}</span>
                        </div>
                        <h2 class="h5 fw-bold mb-2">{{ tournament.name }}</h2>
                        <p class="flex-grow-1 description-text">Учасників: {{ tournament.players }}</p>
                        <a class="btn btn-outline-light mt-3 align-self-start" href="{% url 'get_tournaments' %}">Детальніше про турніри</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}

<div class="page-header mt-5">
    <div>
        <h2 class="mb-1 text-light">Усі турніри</h2>
        <p>Перелік актуальних змагань, доступних на платформі.</p>
    </div>
    <div class="d-flex flex-wrap gap-2">
        <a class="btn btn-outline-light" href="{% url 'get_tournaments' %}">Переглянути списком</a>
        <a class="btn btn-outline-light" href="{% url 'get_tournaments_paginated' %}">Переглянути з пагінацією</a>
    </div>
</div>

{% if all_tournaments %}
    <div class="row g-4">
        {% for tournament in all_tournaments %}
            <div class="col-md-6 col-xl-4">
                <div class="card tournament-card h-100 shadow">
                    <div class="card-media">
                        {% if tournament.banner %}
                            <img src="{{ tournament.banner.url }}" alt="Обкладинка {{ tournament.name }}">
                        {% else %}
                            <div class="card-media__fallback">{{ tournament.name|first|default:"T" }}</div>
                        {% endif %}
                    </div>
                    <div class="card-body d-flex flex-column">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-gradient">{{ tournament.location|default:"Локація не вказана" }}</span>
                            <span class="text-soft small">{{ tournament.date|date:"d.m.Y" }}</span>
                        </div>
                        <h3 class="h5 fw-semibold mb-2">{{ tournament.name }}</h3>
                        <p class="description-text flex-grow-1">{{ tournament.description|default:"Опис буде додано пізніше." }}</p>
                        <div class="card-foot mt-3">
                            <span class="text-soft small">ID: {{ tournament.id }}</span>
                            {% if perms.GamesTournaments.manage_teams %}
                                <a class="btn btn-outline-light btn-sm ms-auto" href="{% url 'add_team' %}">Додати команду</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="row g-4">
        {% for tournament in featured_tournaments %}
            <div class="col-md-6 col-xl-4">
                <div class="card tournament-card h-100 shadow">
                    <div class="card-body d-flex flex-column">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-gradient">{{ tournament.count }} команд</span>
                            <span class="text-soft small">{{ tournament.date|date:"d.m.Y" }}</span>
                        </div>
                        <h3 class="h5 fw-semibold mb-2">{{ tournament.name }}</h3>
                        <p class="description-text flex-grow-1">Станьте першими та додайте власний турнір.</p>
                        <div class="card-foot mt-3">
                            {% if user.is_authenticated %}
                                <a class="btn btn-glow btn-sm ms-auto" href="{% url 'add_tournament' %}">Створити турнір</a>
                            {% else %}
                                <a class="btn btn-outline-light btn-sm ms-auto" href="{% url 'sign_in' %}">Увійти, щоб створити</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}
{% endblock content %}
